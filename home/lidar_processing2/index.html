<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>LiDAR Processing pt.2</title>

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" href="https://nshelton.github.io/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="https://nshelton.github.io/css/font-awesome.min.css">
<link rel="stylesheet" href="https://nshelton.github.io/css/owl.carousel.css">
<link rel="stylesheet" href="https://nshelton.github.io/css/owl.theme.css">


  <link href="https://nshelton.github.io/css/style.default.css" rel="stylesheet" id="theme-stylesheet">



<link rel="stylesheet"
href="https://fonts.googleapis.com/css?family=Noto Sans Mono">


 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="https://nshelton.github.io/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="https://nshelton.github.io/img/favicon.png">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-26353276-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class=" col-sm-4 col-md-2 sidebar-offcanvas d-xs-block">
    <br>
  <div class="sidebar-content">
    <h1 class="sidebar-heading">
      <a href="https://nshelton.github.io">
        sheltron
      </a> 
    </h1>
    <br>
    <p class="social">
  
  
  
  <a href="https://twitter.com/Sheltron3030" data-animate-hover="pulse" class="external twitter">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  <a href="https://www.instagram.com/nshelton" title="" class="external instagram">
    <i class="fa fa-instagram"></i>
  </a>
  
  
  <a href="mailto:nshelton@gmail.com" data-animate-hover="pulse" class="email">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://www.linkedin.com/in/ngshelton/" data-animate-hover="pulse" class="external">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="https://github.com/nshelton" data-animate-hover="pulse" class="external">
    <i class="fa fa-github"></i>
  </a>
  
  
  
</p>

    <br>

    <ul class="sidebar-links">
      
        <a href="https://nshelton.github.io/about/">
            <li>about/ </li>
        </a> 
      
        <a href="https://nshelton.github.io/resources/">
            <li>resources/ </li>
        </a> 
      
        <a href="https://nshelton.github.io/home/">
            <li>home/ </li>
        </a> 
      
        <a href="https://nshelton.github.io/demos/">
            <li>demos/ </li>
        </a> 
      
    </ul>
    <br>
      

    <ul class="sidebar-menu">
      
        
        <a  href="/categories/unity">
          <li class="">unity 24 </li>
        </a>
      
        
        <a  href="/categories/webgl">
          <li class="">webgl 16 </li>
        </a>
      
        
        <a  href="/categories/vj">
          <li class="">vj 15 </li>
        </a>
      
        
        <a  href="/categories/vr">
          <li class="">vr 12 </li>
        </a>
      
        
        <a  href="/categories/demo">
          <li class="">demo 10 </li>
        </a>
      
        
        <a  href="/categories/wave">
          <li class="">wave 9 </li>
        </a>
      
        
        <a  href="/categories/fractals">
          <li class="">fractals 7 </li>
        </a>
      
        
        <a  href="/categories/dataviz">
          <li class="">dataviz 6 </li>
        </a>
      
        
        <a  href="/categories/art">
          <li class="">art 4 </li>
        </a>
      
        
        <a  href="/categories/3dscanning">
          <li class="">3dscanning 3 </li>
        </a>
      
        
        <a  href="/categories/installation">
          <li class="">installation 2 </li>
        </a>
      
        
        <a  href="/categories/ml">
          <li class="">ml 2 </li>
        </a>
      
        
        <a  href="/categories/python">
          <li class="">python 2 </li>
        </a>
      
        
        <a  href="/categories/ar">
          <li class="">ar 1 </li>
        </a>
      
        
        <a  href="/categories/generative">
          <li class="">generative 1 </li>
        </a>
      
    </ul>


  </div>
</div>
 
              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="row">

<br><br><br>
    <div class="col-lg-12">
      <div class="content-column-content">
         <pageTitle>LiDAR Processing pt.2</pageTitle>
         <p>Mar 2016</p>
         <p>more experiments in point cloud reconstruction</p>
<p><img src="/img/lidar2/capitol.jpg" alt="laplacian">
[Texas State Capitol in Austin]</p>
<p>Issues from last time :</p>
<h2 id="tile-artifacts">Tile Artifacts</h2>
<p><img src="/img/lidar2/seam0.jpg" alt="seam0">
[Bottom side of mesh]</p>
<p>First off tried to classify the edges of a mesh and remove the outer shell parts. That&rsquo;s a ton of triangles I could save!</p>
<p><img src="/img/lidar2/seam1.jpg" alt="seam1">
<img src="/img/lidar2/seam2.jpg" alt="seam2"></p>
<p>Then started doing a k - nearest neighbors search between neighboring meshes, and try to tesselate those. But because these has been decimated the vertices were irregular leading to inconsistent merging.</p>
<p>I started using pyMesh Boolean operator like so</p>
<p>merged = pymesh.boolean(f1, f2, operation=&ldquo;union&rdquo;)</p>
<p>which usually merged tiles with minimal artifacts! As long as there was enough overlap in the tiles.</p>
<p><img src="/img/lidar2/merge1.jpg" alt="seam1">
<img src="/img/lidar2/merge2.jpg" alt="seam1"></p>
<h2 id="parametric-box-fitting-to-the-volume-or-the-point-set">Parametric box fitting! (to the volume or the point set)</h2>
<p>this could greatly compress the mesh, and allow me to classify points as trees or buildings! then do other cool stuff?</p>
<p>This was a little ambitious! maybe next time&hellip;</p>
<h2 id="better-ao">Better AO</h2>
<p><img src="/img/lidar2/ao.jpg" alt="ao">
[Congress Ave in Downtown Austin, Texas]</p>
<p>Why reinvent the wheel! I have reconstructions to do! Actually I found a pretty sweet AO generator. The tile artifacts totally destoryed the mesh topology so the UV wrapping didn&rsquo;t work the best, and took forever. But pretty useful tool if you have a decent mesh ! Check out <a href="http://github.prideout.net/">prideout</a>&rsquo;s  <a href="https://github.com/prideout/aobaker">aobaker</a></p>
<p><img src="/img/lidar2/thumb.jpg" alt="seam1"></p>
<h2 id="diferent-subjects">Diferent subjects</h2>
<ul>
<li>GeoTiff are way easier to process into a mesh, because they already have a regular grid and you basically just have to create two triangles for each pixel connecting the neighbors, and set each point to the value of the pixel. No volumes necessary. But i&rsquo;d like to do create visualizations of a lot of different cities.</li>
</ul>
<h2 id="time-lapse">Time lapse:</h2>
<p>Austin is growing super fast and this scan is already 5 years out of date. Now, where could I get an updated scan data&hellip; Google maps? Apple Maps? Going to try using a GLTrace to rip out the vertex positions&hellip; is that allowed?</p>
<p>Update: Whan I have my WebGL inspector for Chrome enabled! 3D maps don&rsquo;t work&hellip; suspicious. Wondering if they did this on purpose for proprietary information reasons, or it&rsquo;s a bug with the inspector driver. Now that I have a windows desktop, maybe I can use apitrace to trick Chrome&hellip;</p>
<hr>
<h2 id="other-stuff-i-started-looking-into">Other stuff I started looking into:</h2>
<h2 id="improved-volume-filtering">Improved Volume filtering</h2>
<p>The objective here is to get maximum detail, smooth interpolation, no gaps, etc. I came up with a few techniques, each with their pros and cons.</p>
<p><img src="/img/lidar/blur.jpg" alt="gaussian"></p>
<h1 id="low-pass--isotropic-diffusion">Low pass / Isotropic Diffusion</h1>
<p>Basically take each point in the volume and make it fill a sphere somehow. To accomplish this, I mark cells that a point lands in with a very high number. Then run a 3D gaussian blur on the volume. This keeps my field mostly continuous, so reconstructing the isosurface is smooth.</p>
<p><img src="/img/lidar2/laplacian.jpg" alt="laplacian"></p>
<h1 id="anisotropic-diffusion">Anisotropic Diffusion</h1>
<p>The Gaussian is one solution to the heat equation, but we don&rsquo;t want to blur edges, so we should weight the gaussian by the gradient.
I implemented this wrong using the laplacian early on and moved on. Gave me some weird patterns inside the volume when I ran marching cubes. This is probably part of the optimal solution, but it still doesn&rsquo;t fill holes. I will revisit this with the right equation next time &hellip;</p>
<p><img src="/img/lidar2/merge3.jpg" alt="seam1">
[capturing individual water pipes at UT Austin campus]</p>
<h1 id="dilation-erosion">Dilation-Erosion</h1>
<p>This is what I finally came up with, which does fill holes, but leaves some blocky artifacts. This could possibly be improved by changing the morphological operator, but can&rsquo;t be removed entirely.</p>
<p>The idea is to create the grid at a much higher sample rate than the points are. Then do the same grid filling with the points you have. There will be tons of gaps where points didn&rsquo;t happen to land, but you just dilate the whole volume, and then erode it the same amount.</p>
<p>I got some really sick detail using this technique. Probably, you want to then blur this high-res grid after that, i just didn&rsquo;t get that far. Maybe the Anisotropic Diffusion comes in handy here</p>
<p><img src="/img/lidar2/glitch.jpg" alt="seam1"></p>
<h2 id="decimation-glitches">decimation glitches!</h2>
<p>Turns out if you are using floats to store lat and lon, the open source decimator I was using kind of craps itself in some kind of precision thing. Looks cool though. My workaround was, take the mesh and translate it so the center is at the origin, run the decimator, and then apply the same inverse translation when finished. This caused me some headaches though, since if my program crashed or I force-quit then I could have model chunks in different fraes of reference D:</p>
<h2 id="conclusion">Conclusion</h2>
<p>I still wasn&rsquo;t able to get a huge reconstruction of the entire data set with these techniques, although I&rsquo;m closer! The main issue is that the dataset is so big and volumetric processing so memory intensive that development time was just slow. Couple this with the fact that the third party pymesh lib would sometimes fail to merge, or there would be tiles in different frames of reference or bad states in my file system, and it would take a while to tell if something was screwed up. Now I have a beefy desktop with GPU though, so GPU accelerated marching cubes is coming up next! Hopefully I can even view the results in realtime for interactive merging and failure detection</p>
        
      </div>
    </div>
    <br>
    <br>
    <br>
    <h1>Related:</h1>
    
    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 masonry-item">
        <div class="box-masonry">
          

              <a href="https://nshelton.github.io/home/lidar_processing/" title="" class="box-masonry-image with-hover-overlay">
              <img src="https://nshelton.github.io/img/lidar/gallery/thumbnail.jpg" alt="" class="img-responsive">
              </a>
            <div class="box-masonry-text">
              <h4><a href="https://nshelton.github.io/home/lidar_processing/">LiDAR Processing</a></h4>
            </div>
        </div>
    </div>
  
    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 masonry-item">
        <div class="box-masonry">
          

              <a href="https://nshelton.github.io/home/thisnode/" title="" class="box-masonry-image with-hover-overlay">
              <img src="https://nshelton.github.io/img/thisnode/thumbnail.jpg" alt="" class="img-responsive">
              </a>
            <div class="box-masonry-text">
              <h4><a href="https://nshelton.github.io/home/thisnode/">this._node</a></h4>
            </div>
        </div>
    </div>
  
    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 masonry-item">
        <div class="box-masonry">
          

              <a href="https://nshelton.github.io/home/tweet/" title="" class="box-masonry-image with-hover-overlay">
              <img src="https://nshelton.github.io/img/tweet/thumbnail.jpg" alt="" class="img-responsive">
              </a>
            <div class="box-masonry-text">
              <h4><a href="https://nshelton.github.io/home/tweet/">tweet</a></h4>
            </div>
        </div>
    </div>
  
    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 masonry-item">
        <div class="box-masonry">
          

              <a href="https://nshelton.github.io/home/atlanta/" title="" class="box-masonry-image with-hover-overlay">
              <img src="https://nshelton.github.io/img/atlanta/thumb.jpg" alt="" class="img-responsive">
              </a>
            <div class="box-masonry-text">
              <h4><a href="https://nshelton.github.io/home/atlanta/">Atlanta </a></h4>
            </div>
        </div>
    </div>
  
    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 masonry-item">
        <div class="box-masonry">
          

              <a href="https://nshelton.github.io/home/lynx/" title="" class="box-masonry-image with-hover-overlay">
              <img src="https://nshelton.github.io/img/lynx/thumbnail.jpg" alt="" class="img-responsive">
              </a>
            <div class="box-masonry-text">
              <h4><a href="https://nshelton.github.io/home/lynx/">Lynx Laboratories</a></h4>
            </div>
        </div>
    </div>
  
    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 masonry-item">
        <div class="box-masonry">
          

              <a href="https://nshelton.github.io/home/openswr/" title="" class="box-masonry-image with-hover-overlay">
              <img src="https://nshelton.github.io/img/openswr/intel-logo.jpg" alt="" class="img-responsive">
              </a>
            <div class="box-masonry-text">
              <h4><a href="https://nshelton.github.io/home/openswr/">OpenSWR</a></h4>
            </div>
        </div>
    </div>
   

  </div>
</div>

          </div>
      </div>
  </div>
  <script src="https://nshelton.github.io/js/jquery.min.js"></script>
<script src="https://nshelton.github.io/js/bootstrap.min.js"></script>
<script src="https://nshelton.github.io/js/jquery.cookie.js"> </script>
<script src="https://nshelton.github.io/js/ekko-lightbox.js"></script>
<script src="https://nshelton.github.io/js/jquery.scrollTo.min.js"></script>
<script src="https://nshelton.github.io/js/masonry.pkgd.min.js"></script>
<script src="https://nshelton.github.io/js/imagesloaded.pkgd.min.js"></script>
<script src="https://nshelton.github.io/js/owl.carousel.min.js"></script>
<script src="https://nshelton.github.io/js/front.js"></script>



</body>
</html>
